# List of loggable service actions

resource: federation:node
service: node

# Default sensitivity for actions
defaultActionSeverity: notice

# default severity for errors
defaultErrorSeverity: error

import:
  - github.com/cortezaproject/corteza-server/federation/types

props:
  - name: node
    type: "*types.Node"
    fields: [ Name, ID, Status, BaseURL ]
  - name: uri
  - name: filter
    type: "*types.NodeFilter"
    fields: [ query, status ]

actions:
  - action: search
    log: "searched for nodes"

  - action: create
    log: "created node"

  - action: createFromURI
    log: "created node from URI"

  - action: ottRegenerated
    log: "regenerated one-time-token for {node}"

  - action: pair
    log: "node pairing started"

  - action: handshakeInit
    log: "node handshake initialized"

  - action: handshakeConfirm
    log: "node handshake confirmed"

  - action: handshakeComplete
    log: "node handshake completed"

errors:
  - error: invalidCreateParams
    message: "provided invalid parameters to create a node"

  - error: unableToCreateUri

  - error: invalidPairingURI
    message: "provided invalid pairing URI"

  - error: uriSourceNodeIDMissing
    message: "provided URI without source ID"

  - error: uriTokenMissing
    message: "provided URI without token"

  - error: invalidHandshakeInitNodeURI
    message: "provided invalid URI to initialize handshake"

  - error: notFound
    message: "node does not exist"
    severity: warning
