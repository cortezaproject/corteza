[
	{
		"title": "Organisations",
		"description": "Organisations represent a top-level grouping entity. There may be many organisations defined in a single deployment.",
		"package": "sam",
		"entrypoint": "organisation",
		"authentication": ["Client ID", "Session ID"],
		"struct": [
			{
				"name": "Organisation",
				"imports": ["time"],
				"fields": [
					{ "name": "ID", "type": "uint64" },
					{ "name": "Name", "type": "string" },
					{ "type": "*time.Time", "name": "ArchivedAt", "tag": "json:\",omitempty\"", "complex": true },
					{ "type": "*time.Time", "name": "DeletedAt", "tag": "json:\",omitempty\"", "complex": true }
				]
			}
		],
		"apis": [
			{
				"name": "list",
				"method": "GET",
				"title": "List organisations",
				"path": "/",
				"parameters": {
					"get": [
						{ "type": "string", "name": "query", "required": false, "title": "Search query" }
					]
				}
			},
			{
				"name": "create",
				"method": "PUT",
				"title": "Create organisation",
				"path": "/",
				"parameters": {
					"post": [
						{ "type": "string", "name": "name", "required": true, "title": "Organisation Name" }
					]
				}
			},
			{
				"name": "edit",
				"method": "POST",
				"title": "Update organisation details",
				"path": "/{id}",
				"parameters": {
					"path": [
						{ "type": "uint64", "name": "id", "required": false, "title": "Organisation ID" }
					],
					"post": [
						{ "type": "string", "name": "name", "required": true, "title": "Organisation Name" }
					]
				}
			},
			{
				"name": "remove",
				"method": "DELETE",
				"title": "Remove organisation",
				"path": "/{id}",
				"parameters": {
					"path": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Organisation ID" }
					]
				}
			},
			{
				"name": "read",
				"method": "GET",
				"title": "Read organisation details",
				"path": "/{id}",
				"parameters": {
					"get": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Organisation ID" }
					]
				}
			},
			{
				"name": "archive",
				"method": "POST",
				"title": "Archive organisation",
				"path": "/{id}/archive",
				"parameters": {
					"path": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Organisation ID" }
					]
				}
			}
		]
	},
	{
		"title": "Teams",
		"description": "An organisation may have many teams. Teams may have many channels available. Access to channels may be shared between teams.",
		"package": "sam",
		"entrypoint": "team",
		"authentication": ["Client ID", "Session ID"],
		"struct": [
			{
				"name": "Team",
				"imports": [ "time" ],
				"fields": [
					{ "type": "uint64", "name": "ID" },
					{ "type": "string", "name": "Name" },
					{ "type": "[]uint64", "name": "MemberIDs", "tag": "json:\"-\"", "complex": true },
					{ "type": "[]User", "name": "Members", "tag": "json:\",omitempty\"", "complex": true },
					{ "type": "*time.Time", "name": "ArchivedAt", "tag": "json:\",omitempty\"", "complex": true },
					{ "type": "*time.Time", "name": "DeletedAt", "tag": "json:\",omitempty\"", "complex": true }
				]
			}
		],
		"apis": [
			{
				"name": "list",
				"method": "GET",
				"title": "List teams",
				"path": "/",
				"parameters": {
					"get": [
						{ "type": "string", "name": "query", "required": false, "title": "Search query" }
					]
				}
			},
			{
				"name": "create",
				"method": "PUT",
				"title": "Update team details",
				"path": "/",
				"parameters": {
					"post": [
						{ "type": "string", "name": "name", "required": true, "title": "Name of Team" },
						{ "type": "[]uint64", "name": "members", "required": false, "title": "Team member IDs" }
					]
				}
			},
			{
				"name": "edit",
				"method": "POST",
				"title": "Update team details",
				"path": "/{id}",
				"parameters": {
					"path": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Team ID" }
					],
					"post": [
						{ "type": "string", "name": "name", "required": false, "title": "Name of Team" },
						{ "type": "[]uint64", "name": "members", "required": false, "title": "Team member IDs" }
					]
				}
			},
			{
				"name": "read",
				"method": "GET",
				"title": "Read team details and memberships",
				"path": "/{id}",
				"parameters": {
					"path": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Organisation ID" }
					]
				}
			},
			{
				"name": "remove",
				"method": "DELETE",
				"title": "Remove team",
				"path": "/{id}",
				"parameters": {
					"path": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Organisation ID" }
					]
				}
			},
			{
				"name": "archive",
				"method": "POST",
				"title": "Archive team",
				"path": "/{id}/archive",
				"parameters": {
					"path": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Organisation ID" }
					]
				}
			},
			{
				"name": "move",
				"method": "POST",
				"title": "Move team to different organisation",
				"path": "/{id}/move",
				"parameters": {
					"path": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Organisation ID" }
					],
					"post": [
						{ "type": "uint64", "name": "organisation_id", "required": true, "title": "Organisation ID" }
					]
				}
			},
			{
				"name": "merge",
				"method": "POST",
				"title": "Merge one team into another",
				"path": "/{id}/merge",
				"parameters": {
					"path": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Source Channel ID" }
					],
					"post": [
						{ "type": "uint64", "name": "destination", "required": true, "title": "Destination Channel ID" }
					]
				}
			}
		]
	},
	{
		"title": "Channels",
		"description": "A channel is a representation of a sequence of messages. It has meta data like channel subject. Channels may be public, private or direct (between two users).",
		"package": "sam",
		"entrypoint": "channel",
		"authentication": ["Client ID", "Session ID"],
		"struct": [
			{
				"name": "Channel",
				"imports": [
					"time",
					"encoding/json"
				],
				"fields": [
					{ "type": "uint64",          "name": "ID" },
					{ "type": "string",          "name": "Name" },
					{ "type": "string",          "name": "Topic", "dbname": "-" },
					{ "type": "json.RawMessage", "name": "Meta", "complex": true},
					{ "type": "uint64",          "name": "LastMessageId", "tag": "json:\",omitempty\"", "dbname": "rel_last_message" },
					{ "type": "*time.Time",      "name": "ArchivedAt",    "tag": "json:\",omitempty\"", "complex": true },
					{ "type": "*time.Time",      "name": "DeletedAt",     "tag": "json:\",omitempty\"", "complex": true }
				]
			}
		],
		"apis": [
			{
				"name": "list",
				"method": "GET",
				"title": "List channels",
				"path": "/",
				"parameters": {
					"GET": [
						{ "type": "string", "name": "query", "required": false, "title": "Search query" }
					]
				}
			},
			{
				"name": "create",
				"method": "PUT",
				"title": "Create new channel",
				"path": "/",
				"parameters": {
					"post": [
						{ "type": "string", "name": "name", "required": true, "title": "Name of Channel" },
						{ "type": "string", "name": "topic", "required": false, "title": "Subject of Channel" }
					]
				}
			},
			{
				"name": "edit",
				"method": "POST",
				"title": "Update channel details",
				"parameters": {
					"post": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Channel ID" },
						{ "type": "string", "name": "name", "required": false, "title": "Name of Channel" },
						{ "type": "string", "name": "topic", "required": false, "title": "Subject of Channel" },
						{ "type": "bool",   "name": "archive", "required": false, "title": "Request channel to be archived or unarchived" },
						{ "type": "uint64", "name": "organisationId", "required": false, "title": "Move channel to different organisation" }
					]
				}
			},
			{
				"name": "read",
				"method": "GET",
				"title": "Read channel details",
				"parameters": {
					"get": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Channel ID" }
					]
				}
			},
			{
				"name": "delete",
				"method": "DELETE",
				"title": "Remove channel",
				"parameters": {
					"get": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Channel ID" }
					]
				}
			}
		]
	},
	{
		"title": "Messages",
		"package": "sam",
		"entrypoint": "message",
		"authentication": ["Client ID", "Session ID"],
		"struct": [
			{
				"name": "Message",
				"imports": ["time"],
				"fields": [
					{ "name": "ID",         "type": "uint64" },
					{ "name": "Type",       "type": "string" },
					{ "name": "Message",    "type": "string" },
					{ "name": "UserId",     "type": "uint64",  "dbname": "rel_user" },
					{ "name": "ChannelId",  "type": "uint64",  "dbname": "rel_channel"},
					{ "name": "ReplyTo",    "type": "uint64",  "dbname": "rel_message" },
					{ "name": "UpdatedAt",  "type": "*time.Time", "tag": "json:\",omitempty\"", "complex": true },
					{ "name": "DeletedAt",  "type": "*time.Time", "tag": "json:\",omitempty\"", "complex": true }

				]
			},
			{
				"name": "Reaction",
				"imports": ["time"],
				"fields": [
					{ "name": "ID",         "type": "uint64" },
					{ "name": "UserId",     "type": "uint64",  "dbname": "rel_user" },
					{ "name": "MessageId",  "type": "uint64",  "dbname": "rel_message"},
					{ "name": "ChannelId",  "type": "uint64",  "dbname": "rel_channel"},
					{ "name": "Reaction",   "type": "string" },
					{ "name": "DeletedAt",  "type": "*time.Time", "tag": "json:\",omitempty\"", "complex": true }
				]
			},
			{
				"name": "Attachment",
				"imports": ["time", "encoding/json"],
				"fields": [
					{ "name": "ID",         "type": "uint64" },
					{ "name": "UserId",     "type": "uint64",  "dbname": "rel_user" },
					{ "name": "MessageId",  "type": "uint64",  "dbname": "rel_message"},
					{ "name": "ChannelId",  "type": "uint64",  "dbname": "rel_channel"},
					{ "name": "Attachment", "type": "json.RawMessage" , "complex": true},
					{ "name": "DeletedAt",  "type": "*time.Time", "tag": "json:\",omitempty\"", "complex": true }
				]
			}
		],
		"apis": [
			{
				"name": "edit",
				"method": "POST",
				"title": "New message / edit message",
				"parameters": {
					"post": [
						{ "type": "uint64", "name": "id", "required": false, "title": "Message ID" },
						{ "type": "uint64", "name": "channel_id", "required": false, "title": "Channel ID where to post message" },
						{ "type": "string", "name": "contents", "required": true, "title": "Message contents (markdown)" }
					]
				}
			},
			{
				"name": "attach",
				"method": "PUT",
				"title": "Attach file to message",
				"params": {
					"get": [
						{ "name": "message_id", "type": "uint64", "title": "Message ID" },
						{ "name": "name", "type": "string", "title": "File name to drop" }
					]
				}
			},
			{
				"name": "remove",
				"method": "DELETE",
				"title": "Remove message",
				"parameters": {
					"get": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Message ID" }
					]
				}
			},
			{
				"name": "read",
				"method": "GET",
				"title": "Read message details",
				"parameters": {
					"post": [
						{ "type": "uint64", "name": "channel_id", "required": true, "title": "Channel ID to read messages from" }
					]
				}
			},
			{
				"name": "search",
				"method": "GET",
				"title": "Search messages",
				"parameters": {
					"get": [
						{ "type": "string", "name": "query", "required": false, "title": "Search string to match against messages" },
						{
							"type": "string",
							"name": "message_type",
							"required": false,
							"title": "Limit results to message type",
							"values": ["history", "message", "attachment", "media"]
						}
					]
				}
			},
			{
				"name": "pin",
				"method": "POST",
				"title": "Pin message to channel (public bookmark)",
				"parameters": {
					"post": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Message ID" }
					]
				}
			},
			{
				"name": "flag",
				"method": "POST",
				"title": "Flag message for user (bookmark)",
				"parameters": {
					"post": [
						{ "type": "uint64", "name": "id", "required": true, "title": "Message ID" }
					]
				}
			}
		]
	},
	{
		"title": "Users",
		"package": "sam",
		"entrypoint": "user",
		"authentication": ["Client ID", "Session ID"],
		"struct": [
			{
				"name": "User",
				"imports": ["time"],
				"fields": [
					{ "type": "uint64", "name": "ID" },
					{ "type": "string", "name": "Username" },
					{ "type": "interface{}", "name": "Meta", "tag": "json:\"-\"" },
					{ "type": "uint64", "name": "OrganisationID", "dbname": "rel_organisation" },
					{ "type": "[]byte", "name": "Password", "tag": "json:\"-\"", "complex": true },
					{ "type": "*time.Time", "name": "SuspendedAt", "tag": "json:\",omitempty\"", "complex": true },
					{ "type": "*time.Time", "name": "DeletedAt", "tag": "json:\",omitempty\"", "complex": true }
				]
			}
		],
		"apis": [
			{
				"name": "login",
				"method": "POST",
				"title": "User login",
				"parameters": {
					"post": [
						{ "type": "string", "name": "username", "required": true, "title": "Username or email" },
						{ "type": "string", "name": "password", "required": true, "title": "Password for user" }
					]
				}
			},
			{
				"name": "search",
				"method": "GET",
				"title": "Search users (Directory)",
				"parameters": {
					"get": [
						{ "type": "string", "name": "query", "required": false, "title": "Search query to match against users" }
					]
				}
			}
		]
	}
]
