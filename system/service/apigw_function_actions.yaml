# List of loggable service actions

resource: system:function
service: apigwFunction

# Default sensitivity for actions
defaultActionSeverity: notice

# default severity for errors
defaultErrorSeverity: error

import:
  - github.com/cortezaproject/corteza-server/system/types

props:
  - name: function
    type: "*types.ApigwFunction"
    fields: [ ID, ref ]
  # - name: new
  #   type: "*types.Route"
  #   fields: [ endpoint, ID ]
  # - name: update
  #   type: "*types.Route"
  #   fields: [ endpoint, ID ]
  - name: search
    type: "*types.ApigwFunctionFilter"
    fields: []

actions:
  - action: search
    log: "searched for function"
    severity: info

  - action: lookup
    log: "looked-up for a {function}"
    severity: info

  - action: create
    log: "created {function}"

  - action: update
    log: "updated {function}"

  - action: delete
    log: "deleted {function}"

  - action: undelete
    log: "undeleted {function}"

errors:
  - error: notFound
    message: "function not found"
    severity: warning

  - error: invalidID
    message: "invalid ID"
    severity: warning

  - error: invalidRoute
    message: "invalid route"
    severity: warning

  - error: notAllowedToCreate
    message: "not allowed to create a function"
    log: "failed to create a route; insufficient permissions"

  - error: notAllowedToRead
    message: "not allowed to read this function"
    log: "failed to read {function}; insufficient permissions"

  - error: notAllowedToUpdate
    message: "not allowed to update this function"
    log: "failed to update {function}; insufficient permissions"

  - error: notAllowedToDelete
    message: "not allowed to delete this function"
    log: "failed to delete {function}; insufficient permissions"

  - error: notAllowedToUndelete
    message: "not allowed to undelete this function"
    log: "failed to undelete {function}; insufficient permissions"
